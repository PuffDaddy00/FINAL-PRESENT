<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-RECYCLE Submissions</title>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles7.css">
</head>
<body>
   <!-- Modal for messages -->
   <div id="messageModal" class="modal flex">
    <div class="modal-content">
        <h2 id="modalTitle" class="text-2xl font-bold mb-4"></h2>
        <p id="modalMessage" class="text-lg text-gray-700"></p>
        <button onclick="closeModal()" class="mt-6 px-6 py-2 bg-blue-600 text-white rounded-full font-bold shadow-md hover:bg-blue-700 transition duration-300">OK</button>
    </div>
</div>

<header class="header">
    <div class="container">
        <a href="#" class="logo-and-name">
            <img src="logo.png" alt="E-RECYCLE Logo" class="header-logo-image-full">
        </a>
        <nav class="nav">
            <a href="#" class="nav-link"onclick="location.href='index4.html'">Home</a>
            <a href="#" class="nav-link"onclick="location.href='index6.html'">Submit</a>
            <a href="#" class="nav-link"onclick="location.href='index7.html'">Submit E-waste</a>
        </nav>
        <div class="auth-buttons">
            <!-- Profile Icon with Dropdown -->
            <div class="profile-container relative">
                <img id="profile-icon" src="https://placehold.co/40x40/ccc/fff?text=ðŸ‘¤" alt="Profile Icon" class="profile-icon">
                <div id="profile-dropdown" class="profile-dropdown">
                    <a href="#" class="profile-dropdown-link" onclick="location.href='index8.html'">Profile</a>
                    <a href="#" class="profile-dropdown-link" onclick="location.href='index2.html'">Logout</a>
    </div>
</header>

    <main class="submissions-main">
        <div class="container">
            <div class="toolbar">
                <div class="toolbar-group">
                    <span class="toolbar-label">Status:</span>
                    <button id="status-all" class="filter-btn status-filter active">All</button>
                    <button id="status-pending" class="filter-btn status-filter">Pending</button>
                    <button id="status-dropped-off" class="filter-btn status-filter">Dropped Off</button>
                    <button id="status-picked-up" class="filter-btn status-filter">Picked Up</button>
                </div>
                <div class="toolbar-group">
                    <span class="toolbar-label">Condition:</span>
                    <button id="condition-all" class="filter-btn condition-filter active">All</button>
                    <button id="condition-working" class="filter-btn condition-filter">Working</button>
                    <button id="condition-broken" class="filter-btn condition-filter">Broken</button>
                </div>
            </div>

            <div class="inbox-header">
                <div class="header-controls">
                    <input type="checkbox" id="select-all" class="select-all-checkbox">
                    <label for="select-all" class="visually-hidden">Select All</label>
                    <div class="action-buttons">
                        <button class="action-btn">
                            <i class="material-icons">delete</i>
                            <span class="btn-text">Delete</span>
                        </button>
                        <button class="action-btn">
                            <i class="material-icons">archive</i>
                            <span class="btn-text">Archive</span>
                        </button>
                    </div>
                </div>
                <div class="header-right">
                    <div class="search-bar">
                        <i class="material-icons search-icon">search</i>
                        <input type="text" id="search-input" placeholder="Search submissions..." aria-label="Search submissions">
                    </div>
                </div>
            </div>

            <div id="inbox-list" class="inbox-list">
                <!-- Submission items will be rendered here by JavaScript -->
            </div>
        </div>
    </main>
    
    <!-- The Modal -->
    <div id="details-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="modal-type"></h2>
            <div id="modal-details"></div>
        </div>
    </div>

    <script>
        // Use document.addEventListener to run the code after the page loads
        document.addEventListener('DOMContentLoaded', () => {

            // Sample data for submissions
            const submissions = [
                { id: 1, type: 'Peripherals', model: 'Keyboard: Razer BlackWidow V3', condition: 'Broken', status: 'Pending', date: '9/15/2025' },
                { id: 2, type: 'PC Components', model: 'Power Supply: Corsair RM850x', condition: 'Working', status: 'Dropped Off', date: '9/14/2025' },
                { 
                    id: 3, 
                    type: 'System Unit', 
                    model: null, 
                    components: [
                        {name: 'CPU', detail: 'i5 10th Gen', condition: 'Working'}, 
                        {name: 'GPU', detail: 'Nvidia RTX 3060', condition: 'Working'},
                        {name: 'Motherboard', detail: 'MSI B450 Tomahawk Max', condition: 'Working'},
                        {name: 'RAM', detail: '16GB DDR4', condition: 'Working'},
                        {name: 'Storage', detail: '512GB SSD', condition: 'Working'},
                        {name: 'Power Supply', detail: '650W PSU', condition: 'Broken'},
                    ], 
                    condition: 'Mixed', 
                    status: 'Dropped Off', 
                    date: '9/12/2025' 
                },
                { 
                    id: 4, 
                    type: 'System Unit', 
                    model: null, 
                    components: [
                        {name: 'CPU', detail: 'i5 8th Gen', condition: 'Working'}, 
                        {name: 'Motherboard', detail: 'ASUS Prime B360M-A', condition: 'Working'},
                        {name: 'RAM', detail: '16GB DDR4', condition: 'Broken'},
                        {name: 'Storage', detail: '1TB HDD', condition: 'Working'},
                        {name: 'Power Supply', detail: '500W PSU', condition: 'Broken'},
                    ], 
                    condition: 'Broken', 
                    status: 'Picked Up', 
                    date: '9/8/2025' 
                },
                { 
                    id: 5, 
                    type: 'System Unit', 
                    model: null, 
                    components: [
                        {name: 'CPU', detail: 'i7 10th Gen', condition: 'Working'}, 
                        {name: 'GPU', detail: 'AMD RX 6700XT', condition: 'Working'}, 
                        {name: 'RAM', detail: '32GB DDR4', condition: 'Working'},
                        {name: 'Storage', detail: '1TB NVMe SSD', condition: 'Working'},
                        {name: 'Power Supply', detail: '750W PSU', condition: 'Working'},
                    ], 
                    condition: 'Working', 
                    status: 'Picked Up', 
                    date: '9/8/2025' 
                },
                { id: 6, type: 'PC Components', model: 'Motherboard: Asus ROG Strix Z490-E', condition: 'Working', status: 'Dropped Off', date: '9/10/2025' },
                { id: 7, type: 'PC Components', model: 'RAM: Corsair Vengeance RGB Pro 16GB', condition: 'Working', status: 'Dropped Off', date: '9/11/2025' },
                { id: 8, type: 'Peripherals', model: 'Monitor: Dell S2721DGF', condition: 'Working', status: 'Picked Up', date: '9/6/2025' },
                { id: 9, type: 'PC Components', model: 'SSD: Samsung 970 EVO Plus 1TB', condition: 'Working', status: 'Dropped Off', date: '9/13/2025' }
            ];

            // Get all the important HTML elements from the page
            const inboxList = document.getElementById('inbox-list');
            const searchInput = document.getElementById('search-input');
            const statusFilterButtons = document.querySelectorAll('.status-filter');
            const conditionFilterButtons = document.querySelectorAll('.condition-filter');
            const modal = document.getElementById('details-modal');
            const closeModalBtn = document.querySelector('.close-btn');
            const modalType = document.getElementById('modal-type');
            const modalDetails = document.getElementById('modal-details');

            // Store the current filter settings
            let currentStatusFilter = 'All';
            let currentConditionFilter = 'All';

            // Function to render the submissions list
            function renderSubmissions(data) {
                // Clear the list first
                inboxList.innerHTML = '';
                
                // If there's no data, show a message
                if (data.length === 0) {
                    inboxList.innerHTML = '<div class="no-results">No submissions found.</div>';
                    return;
                }

                // Loop through each item in the data and create its HTML
                data.forEach(item => {
                    const statusClass = 'status-' + item.status.replace(/\s+/g, '-').toLowerCase();
                    const submissionItem = document.createElement('div');
                    submissionItem.className = 'inbox-item';
                    
                    // Determine the content for the item-model span
                    let itemModelHtml = '';
                    if (item.model) {
                        itemModelHtml = `<span class="item-model">${item.model}</span>`;
                    } else if (item.components) {
                        itemModelHtml = `<span class="item-model">Click for component details</span>`;
                    }

                    // Create the main condition badge, but only if the status isn't 'Pending'
                    let mainConditionBadge = '';
                    if (item.status !== 'Pending') {
                        const conditionClass = 'condition-' + item.condition.replace(/\s+/g, '-').toLowerCase();
                        mainConditionBadge = `<span class="item-condition ${conditionClass}">${item.condition}</span>`;
                    }

                    // Build the full HTML for the list item
                    submissionItem.innerHTML = `
                        <div class="item-left">
                            <input type="checkbox" class="item-checkbox">
                        </div>
                        <div class="item-details">
                            <div class="item-main">
                                <span class="item-type">${item.type}</span>
                                ${itemModelHtml}
                                ${mainConditionBadge}
                            </div>
                            <div class="item-status">
                                <span class="status-badge ${statusClass}">${item.status}</span>
                                <span class="submission-date">${item.date}</span>
                            </div>
                        </div>
                    `;

                    // Add the new list item to the page
                    inboxList.appendChild(submissionItem);

                    // Add a click listener to show the modal with details
                    submissionItem.addEventListener('click', (e) => {
                        // Don't show modal if a checkbox is clicked
                        if (e.target.type === 'checkbox') {
                            e.stopPropagation();
                            return;
                        }
                        
                        // Set modal content
                        modal.style.display = 'block';
                        modalType.textContent = `${item.type}`;
                        
                        let detailsHtml = '';
                        if (item.model) {
                            detailsHtml += `<p><strong>Model:</strong> ${item.model}</p>`;
                        }
                        if (item.components) {
                            detailsHtml += `<p><strong>Components:</strong></p><ul>`;
                            item.components.forEach(c => {
                                const conditionClass = 'condition-' + c.condition.toLowerCase();
                                const conditionSpan = `<span class="item-condition ${conditionClass}">${c.condition}</span>`;
                                detailsHtml += `<li>${c.name}: ${c.detail} ${conditionSpan}</li>`;
                            });
                            detailsHtml += `</ul>`;
                        }
                        detailsHtml += `<p><strong>Status:</strong> ${item.status}</p>`;
                        if (item.status !== 'Pending') {
                            detailsHtml += `<p><strong>Condition:</strong> ${item.condition}</p>`;
                        }
                        detailsHtml += `<p><strong>Date:</strong> ${item.date}</p>`;
                        modalDetails.innerHTML = detailsHtml;
                    });
                });
            }

            // Function to filter and search the submissions based on current settings
            function filterAndSearch() {
                const searchTerm = searchInput.value.toLowerCase();
                
                // Go through each submission and check if it matches all the filters
                const matchingItems = submissions.filter(item => {
                    const statusMatch = currentStatusFilter === 'All' || item.status.replace(/\s+/g, '-') === currentStatusFilter.replace(/\s+/g, '-');
                    
                    // Check condition, but only for non-pending items
                    const conditionMatch = currentConditionFilter === 'All' || item.status === 'Pending' || item.condition?.replace(/\s+/g, '-') === currentConditionFilter.replace(/\s+/g, '-');
                    
                    // Check if the search term is in the item's details
                    const searchMatch = (
                        item.type.toLowerCase().includes(searchTerm) ||
                        (item.model && item.model.toLowerCase().includes(searchTerm)) ||
                        (item.components && item.components.some(c => c.detail.toLowerCase().includes(searchTerm))) ||
                        (item.condition && item.condition.toLowerCase().includes(searchTerm)) ||
                        item.status.toLowerCase().includes(searchTerm)
                    );
                    
                    return statusMatch && conditionMatch && searchMatch;
                });
                
                // Render the items that passed the filters
                renderSubmissions(matchingItems);
            }

            // Set up event listeners for the filter buttons
            statusFilterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    statusFilterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    currentStatusFilter = button.textContent;
                    filterAndSearch();
                });
            });

            conditionFilterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    conditionFilterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    currentConditionFilter = button.textContent;
                    filterAndSearch();
                });
            });

            // Set up event listener for the search input
            searchInput.addEventListener('input', () => {
                filterAndSearch();
            });

            // Set up listener to close the modal
            closeModalBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });

            // Set up listener to close the modal if the user clicks outside of it
            window.addEventListener('click', (event) => {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            });
            const messageModal = document.getElementById('messageModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');

        function showMessage(title, message) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            messageModal.style.display = 'flex';
        }

        function closeModal() {
            messageModal.style.display = 'none';
        }

        window.addEventListener('click', (event) => {
            if (event.target === messageModal) {
                closeModal();
            }
        });
        
        // Profile Dropdown functionality
        const profileIcon = document.getElementById('profile-icon');
        const profileDropdown = document.getElementById('profile-dropdown');

        // Toggle the dropdown visibility
        profileIcon.addEventListener('click', (event) => {
            event.stopPropagation(); // Prevents the window click listener from closing it immediately
            profileDropdown.style.display = profileDropdown.style.display === 'block' ? 'none' : 'block';
        });

        // Close the dropdown when clicking anywhere else on the window
        window.addEventListener('click', (event) => {
            if (!profileIcon.contains(event.target) && !profileDropdown.contains(event.target)) {
                profileDropdown.style.display = 'none';
            }
        });

            // Run the main function to display the initial list of submissions
            filterAndSearch();
        });
    </script>
</body>
</html>
